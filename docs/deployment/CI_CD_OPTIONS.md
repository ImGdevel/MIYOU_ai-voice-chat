# CI/CD 구축 방식 비교 및 권장안

본 문서는 CI/CD 구축 방식들을 비교하고, 현재 프로젝트 특성과 규모에 맞는 권장안을 제시한다.

## 1. 프로젝트 특성 요약
- 단일 서비스 중심(Spring WebFlux RAG)
- Docker 기반 배포 예정
- 레포는 GitHub에 위치
- 운영 규모: 소규모~중간(전용 팀/플랫폼 미보유 가정)
- 요구: 내부 스크립트로 배포 수행

---

## 2. CI/CD 옵션 정리 및 비교

### 옵션 A: GitHub Actions + GHCR + SSH(서버) + Docker Compose
**개요**
- GitHub Actions에서 빌드/테스트/이미지 빌드 후 GHCR에 푸시
- 서버에서 SSH로 접속해 이미지 pull 및 docker compose up -d 실행

**장점**
- GitHub에 최적화된 기본 선택지
- 설정 간단, 운영 비용 낮음
- PR 기반 품질 게이트(테스트/리뷰)와 잘 맞음

**단점**
- 서버 관리(보안 패치, 모니터링)는 별도 필요
- 멀티 서비스/대규모 확장에는 한계

**적합 상황**
- 단일 서비스, 인프라 단순, 빠른 도입 필요

---

### 옵션 B: GitHub Actions + Docker Hub + SSH + Docker Compose
**개요**
- 이미지 레지스트리를 GHCR 대신 Docker Hub로 사용

**장점**
- 레지스트리 호환성 높음
- 외부 인프라와 연동 사례 많음

**단점**
- GitHub와 통합 수준은 GHCR보다 낮음
- 프라이빗 이미지 비용/정책 고려 필요

**적합 상황**
- 이미 Docker Hub 표준화가 되어 있는 조직

---

### 옵션 C: GitHub Actions + AWS ECS/Fargate
**개요**
- 빌드 후 ECR 푸시, ECS 서비스 업데이트

**장점**
- 서버 관리 부담 없음
- 자동 스케일, 롤백/배포 안정성 우수

**단점**
- 비용 증가, 설정 복잡
- AWS 인프라 이해 필요

**적합 상황**
- 성장/확장 계획이 뚜렷한 서비스

---

### 옵션 D: Jenkins 기반 (Self-Hosted)
**개요**
- 자체 CI/CD 서버 구축, 파이프라인 스크립트 관리

**장점**
- 유연성 높음
- 레거시 환경 호환 가능

**단점**
- 운영 비용 높고 관리 복잡
- 소규모 팀에는 과한 선택

**적합 상황**
- 사내 정책상 GitHub Actions 사용 불가

---

### 옵션 E: GitLab CI/CD
**개요**
- GitLab 내장 CI/CD 파이프라인 사용

**장점**
- GitLab 레포와 강결합
- 통합 경험 우수

**단점**
- GitHub 기반 프로젝트엔 이관 비용 발생

**적합 상황**
- GitLab 사용이 표준인 조직

---

### 옵션 F: Kubernetes + Argo CD (GitOps)
**개요**
- 이미지 빌드 후 GitOps 리포에 매니페스트 갱신
- Argo CD가 자동 동기화 배포

**장점**
- 대규모/멀티서비스 운영에 최적
- 배포 이력/정책 관리 강력

**단점**
- 인프라 비용/운영 난이도 높음
- 현재 규모에 과함

**적합 상황**
- 다수 서비스/팀, SLA 강한 환경

---

## 3. 비교 요약(핵심 관점)
- 도입 난이도: A < B < C < D/F
- 운영 비용: A/B 낮음, C 중간, D/F 높음
- 확장성: F > C > A/B
- 현재 프로젝트 적합성: A가 가장 합리적

---

## 4. 권장안

### ✅ 권장: **옵션 A (GitHub Actions + GHCR + SSH + Docker Compose)**

**이유**
- GitHub 기반 개발 흐름과 자연스럽게 통합됨
- 인프라 단순성과 비용 효율이 뛰어남
- 요구사항인 “내부 스크립트 기반 배포”를 쉽게 만족

**예상 구성**
1) GitHub Actions
   - 테스트 → 빌드 → Docker 이미지 생성
   - GHCR에 이미지 push
2) 배포 스크립트(서버 내 or 레포 포함)
   - 최신 이미지 pull
   - docker compose up -d
   - 헬스체크

---

## 5. 다음 단계(제안)
1) GHCR 사용 여부 확정
2) 서버 배포 방식 확정(SSH 대상 서버 정보)
3) 배포 스크립트 설계 및 CI 파이프라인 작성

필요하면 위 권장안 기준으로 실제 CI/CD 파일과 배포 스크립트를 바로 구성할 수 있다.
